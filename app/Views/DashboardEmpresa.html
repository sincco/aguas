{% spaceless %}
{% include 'header_full.html' %}
{% include 'menu.html' %}

<div class="container">
	<div id="page-wrapper dashboard" style="min-height: 129px;">
		<div class="row">
			<div class="col-lg-12">
				<h1 class="page-header">Métricas de gestión por empresas</h1>
			</div>
		</div>
	</div>
	
	<!--
	<div class="row">
		<div class="col-xs-12">
			<div class="row">
				<div class='col-xs-1'>
					Desde
				</div>
				<div class='col-xs-5'>
					<div class="form-group">
					<div class='input-group date' id='fecha-inicio'>
					<input type='text' class="form-control" id="fechaInicio" value="{{desde}}" />
					<span class="input-group-addon">
					<span class="glyphicon glyphicon-calendar"></span>
					</span>
					</div>
					</div>
				</div>
				<div class='col-xs-1'>
					Hasta
				</div>
				<div class='col-xs-5'>
					<div class="form-group">
					<div class='input-group date' id='fecha-fin'>
					<input type='text' class="form-control" id="fechaFin" value="{{hasta}}"/>
					<span class="input-group-addon">
					<span class="glyphicon glyphicon-calendar"></span>
					</span>
					</div>
					</div>
				</div>
				<div class='col-xs-4'>
					<button type="button" class="btn btn-success" onclick="{{_self.getTemplateName() | replace( { '.html':'' } ) | lower }}.filtrar()">Filtrar</button>
				</div>
			</div>
		</div>
	</div>
	-->
	<div class="row">
		{% for grafica in graficas %}
		<div class="col-xs-12 col-md-6">
			<h4>{{grafica.titulo}}</h4>
			<div id="grafica{{grafica.id}}" class="chart"></div>
		</div>
		{% endfor %}
	</div>

</div>


<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script type="text/javascript">
google.charts.load("current", {packages:['corechart']});
{% for grafica in graficas %}
	google.charts.setOnLoadCallback(dibujaGrafica{{grafica.id}});
	{% if grafica.tipo == 'pie' %}
	function dibujaGrafica{{grafica.id}}() {
		var data = google.visualization.arrayToDataTable([
		  ['Estatus', 'Contratos'],
		  {% for dato in grafica.datos %}
		  ['{{dato.estatus}}', {{dato.contratos}}],
		  {% endfor %}
		]);
		var options = {
		};
		var chart = new google.visualization.PieChart(document.getElementById('grafica{{grafica.id}}'));
		chart.draw(data, options);
	}
	{% else %}
	function dibujaGrafica{{grafica.id}}() {
	  var data = google.visualization.arrayToDataTable([
		['Estatus', 'Contratos', { role: 'style' }],
		{% for dato in grafica.datos %}
		{% set randomColor = [] %}
		{% for i in 1..6 %}
			{% set alpha = 'abcdef' %}
			{% set alphaUpper = alpha|upper %}
			{% set numbers = '0123456789' %}
			{% set randomCharacter = random(alpha ~ alphaUpper ~ numbers ~ '-_') %}
			{% set randomColor = randomColor|merge([randomCharacter]) %}
		{% endfor %}
		{% set randomColor = randomColor|join %}
		['{{dato.estatus}}', {{dato.contratos}}, '#{{randomColor}}'],
		{% endfor %}
	  ]);
	  var view = new google.visualization.DataView(data);
	  view.setColumns([0, 1,
					   { calc: "stringify",
						 sourceColumn: 1,
						 type: "string",
						 role: "annotation" },
					   2]);
	  var options = {
		bar: {groupWidth: "95%"},
		legend: { position: "none" },
	  };
	  var chart = new google.visualization.ColumnChart(document.getElementById('grafica{{grafica.id}}'));
	  chart.draw(view, options);
	}

	{% endif %}
{% endfor %}
</script>

<script type="text/javascript">{{_self.getTemplateName() | replace( { '.html':'' } ) | lower }}.init();</script>

{% include 'footer_full.html' %}
{% endspaceless %}
